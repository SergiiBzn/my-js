---
sidebar_position: 1
title: –í–∑–≤–µ—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞
description: –í–∑–≤–µ—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞
keywords: ['javascript', 'js', 'algorithms', '–∞–ª–≥–æ—Ä–∏—Ç–º—ã']
tags: ['javascript', 'js', 'algorithms', '–∞–ª–≥–æ—Ä–∏—Ç–º—ã']
---

# –í–∑–≤–µ—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞

<img src="https://habrastorage.org/webt/e9/94/i2/e994i2o7uknxvrwxlxocf8amr9k.png" />
<br />

__–û–ø–∏—Å–∞–Ω–∏–µ__

- [–ß—Ç–æ —Ç–∞–∫–æ–µ –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞?](https://ru.statisticseasily.com/glossario/what-is-weighted-random-sampling/)
- [GitHub](https://github.com/harryheman/algorithms-data-structures/blob/main/src/algorithms/statistics/weighted-random.js)

–î–æ–ø—É—Å—Ç–∏–º, —É –Ω–∞—Å –µ—Å—Ç—å —Å–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –≠–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å —á–µ–º —É–≥–æ–¥–Ω–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, —É –Ω–∞—Å –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ø–∏—Å–æ–∫ —Ñ—Ä—É–∫—Ç–æ–≤ –∏ –æ–≤–æ—â–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã –ª—é–±–∏–º –∫—É—à–∞—Ç—å: `[ 'üçå', 'üçé', 'ü•ï' ]`.

–°–ø–∏—Å–æ–∫ –≤–µ—Å–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –≤–µ—Å (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞, –≤–∞–∂–Ω–æ—Å—Ç—å) –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –í–µ—Å–∞ - —ç—Ç–æ —á–∏—Å–ª–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤–µ—Å–∞ `[3, 7, 1]` –æ–∑–Ω–∞—á–∞—é—Ç —Å–ª–µ–¥—É—é—â–µ–µ:

- –º—ã –≤—ã–±–∏—Ä–∞–µ–º —è–±–ª–æ–∫–æ —á–∞—â–µ –≤—Å–µ–≥–æ (`7` –∏–∑ `3+7+1=11` —Ä–∞–∑)
- –±–∞–Ω–∞–Ω –º—ã –≤—ã–±–∏—Ä–∞–µ–º –º–µ–Ω–µ–µ —á–∞—Å—Ç–æ (`3` –∏–∑ `11` —Ä–∞–∑)
- –º–æ—Ä–∫–æ–≤–∫—É –º—ã –Ω–µ –ª—é–±–∏–º, –ø–æ—ç—Ç–æ–º—É –≤—ã–±–∏—Ä–∞–µ–º –µ–µ —Ä–µ–¥–∫–æ (`1` –∏–∑ `11` —Ä–∞–∑)

> –ï—Å–ª–∏ –≥–æ–≤–æ—Ä–∏—Ç—å –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, —Ç–æ –≤–µ—Å–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —á–∏—Å–ª–∞–º–∏ —Å –ø–ª–∞–≤–∞—é—â–µ–π –∑–∞–ø—è—Ç–æ–π, —Å—É–º–º–∞ –∫–æ—Ç–æ—Ä—ã—Ö –¥–∞–µ—Ç `1` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `[0.1, 0.5, 0.2, 0.2]`).

–í–∑–≤–µ—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ (weighted random) - —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç —Å–ø–∏—Å–∫–∞ —Å —É—á–µ—Ç–æ–º –µ–≥–æ –≤–µ—Å–∞, –ø–æ—ç—Ç–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—ã —Å –±–æ–ª—å—à–∏–º –≤–µ—Å–æ–º –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —á–∞—â–µ.

–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Ñ—É–Ω–∫—Ü–∏–∏:

```javascript
const items =   [ 'üçå', 'üçé', 'ü•ï' ];
const weights = [  3,    7,    1  ];

function weightedRandom(items, weights) {
  // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è...
}

const nextSnackToEat = weightedRandom(items, weights); // –≤–µ—Ä–æ—è—Ç–Ω–µ–µ –≤—Å–µ–≥–æ –±—É–¥–µ—Ç 'üçé'
```

__–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ__

- –≤ [–≥–µ–Ω–µ—Ç–∏—á–µ—Å–∫–æ–π –∞–ª–≥–æ—Ä–∏—Ç–º–µ](https://ru.wikipedia.org/wiki/%D0%93%D0%B5%D0%BD%D0%B5%D1%82%D0%B8%D1%87%D0%B5%D1%81%D0%BA%D0%B8%D0%B9_%D0%B0%D0%BB%D0%B3%D0%BE%D1%80%D0%B8%D1%82%D0%BC) –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ —Å—Ç–∞–¥–∏–∏ –≤—ã–±–æ—Ä–∫–∏, –∫–æ–≥–¥–∞ –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–Ω—ã—Ö/—Å–∏–ª—å–Ω—ã—Ö –æ—Å–æ–±–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ü–µ–Ω–∫–∏ –∏—Ö –ø—Ä–∏—Å–ø–æ—Å–æ–±–ª–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è —Å–ø–∞—Ä–∏–≤–∞–Ω–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –±–æ–ª–µ–µ —Å–∏–ª—å–Ω–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è. –°–º. [–°–∞–º–æ–ø–∞—Ä–∫—É—é—â–∏–π—Å—è –∞–≤—Ç–æ –∑–∞ 500 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞](https://habr.com/ru/users/aio350/articles/page2/)
- –≤ [—Ä–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç—è—Ö (RNN)](https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%BA%D1%83%D1%80%D1%80%D0%B5%D0%BD%D1%82%D0%BD%D0%B0%D1%8F_%D0%BD%D0%B5%D0%B9%D1%80%D0%BE%D0%BD%D0%BD%D0%B0%D1%8F_%D1%81%D0%B5%D1%82%D1%8C) –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏—è –æ –≤—ã–±–æ—Ä–µ —Å–ª–µ–¥—É—é—â–µ–π –±—É–∫–≤—ã (–¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è) –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â–µ–π –±—É–∫–≤—ã. –°–º. Jupyter Notebook [Recipe Generation using Recurrent Neural Network (RNN)](https://nbviewer.org/github/trekhleb/machine-learning-experiments/blob/master/experiments/recipe_generation_rnn/recipe_generation_rnn.ipynb)
- –≤ [–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤—â–∏–∫–µ –Ω–∞–≥—Ä—É–∑–∫–∏ Nginx](https://docs.nginx.com/nginx/admin-guide/load-balancer/http-load-balancer/) –¥–ª—è –±–æ–ª–µ–µ —á–∞—Å—Ç–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º –≤–µ—Å–æ–º
- –≤–æ –º–Ω–æ–≥–∏—Ö –¥—Ä—É–≥–∏—Ö –æ–±–ª–∞—Å—Ç—è—Ö

__–ê–ª–≥–æ—Ä–∏—Ç–º__

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º:

1. –î—É–±–ª–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –µ–≥–æ –≤–µ—Å–æ–º.
2. –í—ã–±–∏—Ä–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç.

–ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –Ω–∞—à–∏—Ö —Ñ—Ä—É–∫—Ç–æ–≤ –∏ –æ–≤–æ—â–µ–π –º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Å–ø–∏—Å–æ–∫:

```javascript
const items =   [ 'üçå', 'üçé', 'ü•ï' ];
const weights = [  3,    7,    1  ];

// –î—É–±–ª–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö –≤–µ—Å–æ–≤
const weightedItems = [
  'üçå', 'üçå', 'üçå',
  'üçé', 'üçé', 'üçé', 'üçé', 'üçé', 'üçé', 'üçé',
  'ü•ï',
];

// –¢–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ –∏–∑–≤–ª–µ–∫–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ `weightedItems`
```

–û–¥–Ω–∞–∫–æ, –∫–∞–∫ –≤—ã –º–æ–∂–µ—Ç–µ –≤–∏–¥–µ—Ç—å, —Ç–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–∞–º—è—Ç–∏ –≤ —Å–ª—É—á–∞–µ, –∫–æ–≥–¥–∞ —É –Ω–∞—Å –º–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ `"some-random-string"` 10 –º–ª–Ω —Ä–∞–∑ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –≤—ã–¥–µ–ª–µ–Ω–∏—è –æ–∫–æ–ª–æ `180 –ú–±` –ø–∞–º—è—Ç–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –º–∞—Å—Å–∏–≤–∞ `weightedItems`.

–ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º:

1. –ì–æ—Ç–æ–≤–∏–º —Å–ø–∏—Å–æ–∫ —Å–æ–≤–æ–∫—É–ø–Ω—ã—Ö –≤–µ—Å–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (—Å–ø–∏—Å–æ–∫ `cumulativeWeights` –±—É–¥–µ—Ç –∏–º–µ—Ç—å —Ç–∞–∫—É—é –∂–µ –¥–ª–∏–Ω—É, –∫–∞–∫ –∏—Å—Ö–æ–¥–Ω—ã–π —Å–ø–∏—Å–æ–∫ `weights`). –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ –æ–Ω –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫: `cumulativeWeights = [3, 3 + 7, 3 + 7 + 1] = [3, 10, 11]`.
2. –í—ã–±–∏—Ä–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç `0` –¥–æ –Ω–∞–∏–±–æ–ª—å—à–µ–≥–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ–≥–æ –≤–µ—Å–∞. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ —Ç–∞–∫–∏–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º –±—É–¥–µ—Ç `[0...11]`. –î–æ–ø—É—Å—Ç–∏–º, –º—ã –ø–æ–ª—É—á–∏–ª–∏ `randomNumber = 8`.
3. –ü–µ—Ä–µ–±–∏—Ä–∞–µ–º `cumulativeWeights` —Å–ª–µ–≤–∞ –Ω–∞–ø—Ä–∞–≤–æ –∏ –±–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω `randomNumber`. –ò–Ω–¥–µ–∫—Å —Ç–∞–∫–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—ã–±–æ—Ä–∞ —ç–ª–µ–º–µ–Ω—Ç–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ `items`.

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è –¥–∞–Ω–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–µ –≤–µ—Å–∞ –±—É–¥—É—Ç "–∑–∞–Ω–∏–º–∞—Ç—å" –±–æ–ª—å—à–µ —á–∏—Å–ª–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ –∏–∑ "—á–∏—Å–ª–æ–≤–æ–π –≥—Ä—É–ø–ø—ã –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–≥–æ –≤–µ—Å–∞".

```javascript
const weights =           [3, 7,  1 ];
const cumulativeWeights = [3, 10, 11];

// `cumulativeWeights` –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Ç–∞–∫
const pseudoCumulativeWeights = [
  1, 2, 3,               // <-- 3 —á–∏—Å–ª–∞
  4, 5, 6, 7, 8, 9, 10,  // <-- 7 —á–∏—Å–µ–ª
  11,                    // <-- 1 —á–∏—Å–ª–æ
];
```

__–†–µ–∞–ª–∏–∑–∞—Ü–∏—è__

```javascript
// algorithms/statistics/weighted-random.js
/**
 * –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –≤–µ—Å–∞.
 * –≠–ª–µ–º–µ–Ω—Ç—ã —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º –≤–µ—Å–æ–º –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —á–∞—â–µ (—Å –±–æ–ª—å—à–µ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é).
 *
 * –ù–∞–ø—Ä–∏–º–µ—Ä:
 * - items = ['banana', 'orange', 'apple']
 * - weights = [0, 0.2, 0.8]
 * - weightedRandom(items, weights) –≤ 80% —Å–ª—É—á–∞–µ–≤ –±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 'apple',
 * –≤ 20% —Å–ª—É—á–∞–µ–≤ - 'orange' –∏ –Ω–∏–∫–æ–≥–¥–∞ - 'banana' (–ø–æ—Å–∫–æ–ª—å–∫—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –µ–≥–æ –≤—ã–±–æ—Ä–∞ —Ä–∞–≤–Ω–∞ 0%)
 *
 * @param {any[]} items
 * @param {number[]} weights
 * @returns {{item: any, index: number}}
 */
export default function weightedRandom(items, weights) {
  if (!items.length || !weights.length) {
    throw new Error('–≠–ª–µ–º–µ–Ω—Ç—ã/–≤–µ—Å–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏')
  }
  if (items.length !== weights.length) {
    throw new Error('–ú–∞—Å—Å–∏–≤—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –≤–µ—Å–æ–≤ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –¥–ª–∏–Ω—É')
  }

  // –ì–æ—Ç–æ–≤–∏–º –º–∞—Å—Å–∏–≤ —Å–æ–≤–æ–∫—É–ø–Ω—ã—Ö –≤–µ—Å–æ–≤.
  // –ù–∞–ø—Ä–∏–º–µ—Ä:
  // - weights = [1, 4, 3]
  // - cumulativeWeights = [1, 5, 8]
  const cumulativeWeights = []
  for (let i = 0; i < weights.length; i++) {
    cumulativeWeights[i] = weights[i] + (cumulativeWeights[i - 1] || 0)
  }

  // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [0...sum(weights)].
  // –ù–∞–ø—Ä–∏–º–µ—Ä:
  // - weights = [1, 4, 3]
  // - maxCumulativeWeight = 8
  // - –¥–∏–∞–ø–∞–∑–æ–Ω –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ - [0...8]
  const maxCumulativeWeight = cumulativeWeights.at(-1)
  const random = Math.random() * maxCumulativeWeight

  // –ò–∑–≤–ª–µ–∫–∞–µ–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –µ–≥–æ –≤–µ—Å–∞.
  // –≠–ª–µ–º–µ–Ω—Ç—ã —Å –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º –≤–µ—Å–æ–º –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —á–∞—â–µ
  const index = cumulativeWeights.findIndex((cumulativeWeight) => {
    return cumulativeWeight >= random
  })
  const item = items[index]

  return {
    item,
    index,
  }
}
```

<spoiler title="–¢–µ—Å—Ç—ã:">

```javascript
import weightedRandom from '../weighted-random'

describe('weightedRandom', () => {
  it('–ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ –ø—É—Å—Ç–æ–≥–æ –º–∞—Å—Å–∏–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–ª–∏ –≤–µ—Å–æ–≤ –¥–æ–ª–∂–Ω–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ', () => {
    const getWeightedRandomWithInvalidInputs = () => {
      weightedRandom([], [])
    }
    expect(getWeightedRandomWithInvalidInputs).toThrow(
      '–≠–ª–µ–º–µ–Ω—Ç—ã/–≤–µ—Å–∞ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—É—Å—Ç—ã–º–∏',
    )
  })

  it('–ø—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –≤–µ—Å–æ–≤ –¥–æ–ª–∂–Ω–æ –≤—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å—Å—è –∏—Å–∫–ª—é—á–µ–Ω–∏–µ', () => {
    const getWeightedRandomWithInvalidInputs = () => {
      weightedRandom(['a', 'b', 'c'], [10, 0])
    }
    expect(getWeightedRandomWithInvalidInputs).toThrow(
      '–ú–∞—Å—Å–∏–≤—ã —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏ –≤–µ—Å–æ–≤ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –¥–ª–∏–Ω—É',
    )
  })

  it('–¥–æ–ª–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤–∑–≤–µ—à–µ–Ω–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é –≤—ã–±–æ—Ä–∫—É –≤ –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞—è—Ö', () => {
    expect(weightedRandom(['a', 'b', 'c'], [1, 0, 0])).toEqual({
      index: 0,
      item: 'a',
    })
    expect(weightedRandom(['a', 'b', 'c'], [0, 1, 0])).toEqual({
      index: 1,
      item: 'b',
    })
    expect(weightedRandom(['a', 'b', 'c'], [0, 0, 1])).toEqual({
      index: 2,
      item: 'c',
    })
    expect(weightedRandom(['a', 'b', 'c'], [0, 1, 1])).not.toEqual({
      index: 0,
      item: 'a',
    })
    expect(weightedRandom(['a', 'b', 'c'], [1, 0, 1])).not.toEqual({
      index: 1,
      item: 'b',
    })
    expect(weightedRandom(['a', 'b', 'c'], [1, 1, 0])).not.toEqual({
      index: 2,
      item: 'c',
    })
  })

  it('–¥–æ–ª–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤–∑–≤–µ—à–µ–Ω–Ω—É—é –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é –≤—ã–±–æ—Ä–∫—É', () => {
    // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–±–æ—Ä–æ–∫
    const ATTEMPTS_NUM = 1000
    // –ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—ã–±–æ—Ä–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–∞.
    // –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º, —á—Ç–æ–±—ã —ç–ª–µ–º–µ–Ω—Ç 'a' –≤—ã–±–∏—Ä–∞–ª—Å—è 300 —Ä–∞–∑ –∏–∑ 1000 (30%),
    // —Ç–æ–≥–¥–∞ 267 —Ä–∞–∑ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–µ–º–ª–µ–º—ã–º, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –±–æ–ª—å—à–µ 250 (300 - 50)
    // –∏ –º–µ–Ω—å—à–µ 350 (300 + 50)
    const THRESHOLD = 50

    const items = ['a', 'b', 'c'] // –∑–Ω–∞—á–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ–≤–∞–∂–Ω—ã
    const weights = [0.1, 0.3, 0.6]

    const counter = []
    for (let i = 0; i < ATTEMPTS_NUM; i += 1) {
      const randomItem = weightedRandom(items, weights)
      if (!counter[randomItem.index]) {
        counter[randomItem.index] = 1
      } else {
        counter[randomItem.index] += 1
      }
    }

    for (let itemIndex = 0; itemIndex < items.length; itemIndex += 1) {
      /*
        –≠–ª–µ–º–µ–Ω—Ç –ø–æ–¥ –∏–Ω–¥–µ–∫—Å–æ–º 0 –¥–æ–ª–∂–µ–Ω –≤—ã–±–∏—Ä–∞—Ç—å—Å—è 100 —Ä–∞–∑ (–≤ –∏–¥–µ–∞–ª–µ)
        –∏–ª–∏, —É—á–∏—Ç—ã–≤–∞—è –ø–æ—Ä–æ–≥, [100 - 50, 100 + 50] —Ä–∞–∑.

        –≠–ª–µ–º–µ–Ω—Ç –ø–æ–¥ –∏–Ω–¥–µ–∫—Å–æ–º 1 –¥–æ–ª–∂–µ–Ω –≤—ã–±–∏—Ä–∞—Ç—å—Å—è 300 —Ä–∞–∑ (–≤ –∏–¥–µ–∞–ª–µ)
        –∏–ª–∏, —É—á–∏—Ç—ã–≤–∞—è –ø–æ—Ä–æ–≥, [300 - 50, 300 + 50] —Ä–∞–∑.

        –≠–ª–µ–º–µ–Ω—Ç –ø–æ–¥ –∏–Ω–¥–µ–∫—Å–æ–º 2 –¥–æ–ª–∂–µ–Ω –≤—ã–±–∏—Ä–∞—Ç—å—Å—è 600 —Ä–∞–∑ (–≤ –∏–¥–µ–∞–ª–µ)
        –∏–ª–∏, —É—á–∏—Ç—ã–≤–∞—è –ø–æ—Ä–æ–≥, [600 - 50, 600 + 50] —Ä–∞–∑
       */
      expect(counter[itemIndex]).toBeGreaterThan(
        ATTEMPTS_NUM * weights[itemIndex] - THRESHOLD,
      )
      expect(counter[itemIndex]).toBeLessThan(
        ATTEMPTS_NUM * weights[itemIndex] + THRESHOLD,
      )
    }
  })
})
```

</spoiler>

–ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã:

```bash
npm run test ./algorithms/statistics
```

<img src="https://habrastorage.org/webt/b4/vf/m-/b4vfm-aglfggwqjagfsl9g-uqsq.png" />
<br />
